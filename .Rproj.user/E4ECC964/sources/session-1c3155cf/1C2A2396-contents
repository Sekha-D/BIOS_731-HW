---
title: "BIOS761/EPI760 Homework 2"
author: "Sekha Daluwatumulle"
output: 
  pdf_document:
    extra_dependencies: ["booktabs", "float", "multirow"]
    keep_tex: false
    highlight: haddock
urlcolor: blue    
---

__Instructions__: Write answers in complete sentences where appropriate.

Consider the example we discussed in class where:

- $W$ = receipt of chemotherapy
- $A$ = receipt of radiation therapy
- $V$ = late stage diagnosis
- $Y(a)$ = counterfactual survival time from diagnosis under assignment to radition therapy level $a$ (0 or 1)
- $Y(a,w)$ = counterfactual survival time from diagnosis under assignment to radition therapy level $a$ (0 or 1) and chemotherapy level $w$ (0 or 1)

1. (1 pt) What result allows you to write \begin{equation} \label{eqn:marginal_Yaw}
E[Y(a,w)] = \sum_{v} E[Y(a,w) \mid V = v] P(V = v) \ ?
\end{equation} 
Provide a real-world interpretation of each side of this equation.

Tower rules allows us to write the above equation.

Left hand side: The average counterfactual survival time from diagnosis under assignment to radiation therapy level $a$ (0 or 1) and chemotherapy level $w$ (0 or 1)

Right hand side: Summation of the average counterfactual survival times from diagnosis under assignment to radiation therapy level $a$ (0 or 1) and chemotherapy level $w$ (0 or 1) of each of the late stage diagnosis levels weighted on the probability of the late stage diagnosis level. 

2. (1 pt) Define $E[Y(a) \mid W = w]$ in real world terms and explain what it means for there to be treatment effect heterogeneity in this example.

The average counterfactual survival time from diagnosis under assignment to radiation therapy level $a$ (0 or 1) of the sub population of patients that received chemotherapy level $w$ (0 or 1).
Treatment effect heterogeneity means that the average difference of counterfactual survival times from diagnosis under assignment to radiation therapy level $a=1$ versus $a=0$ is different for each of the sub populations of patients that received chemotherapy level $w$ (0 or 1). 

3. (1 pt) It turns out that under assumptions (see bonus question below) \begin{equation} \label{eqn:conditional_Ya}
  E[Y(a) \mid W = w] = \sum_{v} E[Y(a,w) \mid V = v] P(V = v \mid W = w) \ .
\end{equation}
Compare the right hand sides of equations (\ref{eqn:marginal_Yaw}) and (\ref{eqn:conditional_Ya}). What is different between the equations?

Equation 1 uses the average counterfactual survival time from diagnosis under assignment  to radiation therapy level $a$ (0 or 1) and chemotherapy level $w$ (0 or 1). This use the joint distribution of $A$ and $W$. The right hand side of this equation uses probability of each of the late stage diagnosis level as weights. The second equation utilizes the conditional distribution of $A$ given $W$ to find the average counterfactual survival time from diagnosis under assignment  to radiation therapy level $a$ (0 or 1) for the subpopulation of patients that received chemotherapy level $w$ (0 or 1). The right hand side of this equation use the conditional probability of late stage diagnosis level given the chemotherapy level as weights. This is the main difference of the two equations.

4. (1 pt) Suppose the joint distribution of ($W, V$) is shown below:

\begin{table}[H]
\centering
\begin{tabular}{c|cc}
\toprule
      & $V=0$ & $V=1$ \\
\midrule
$W=0$ &  3/8  &  1/8  \\
$W=1$ &  1/8  &  3/8  \\
\bottomrule
\end{tabular}
\end{table}

That is $P(W = 0, V = 0) = 3/8$, $P(W = 0, V = 1) = 1/8$, etc... Fill in the following table.

\begin{table}[H]
\centering
\begin{tabular}{cc|cc}
\toprule
$v$  & $w$ & $P(V = v)$ & $P(V = v \mid W = w)$\\
\midrule
 0   &  0  & \multirow{3}{4em}{$\frac{4}{8}=\frac{1}{2}$} & $\frac{\frac{3}{8}}{\frac{3}{8}+\frac{1}{8}}$=$\frac{3}{4}$\\
 &&&\\
 0   &  1  & &  $\frac{1}{4}$\\
  &&&\\
 1   &  0  & \multirow{3}{4em}{$\frac{4}{8}=\frac{1}{2}$} & $\frac{1}{4}$\\
  &&&\\
 1   &  1  & & $\frac{3}{4}$\\
\bottomrule
\end{tabular}
\end{table}

5. (1pt) For each $(v,w)$ combination, comment on the weights assigned to subgroups defined by late stage diagnosis ($V$) by both $E[Y(a,w)]$ and $E[Y(a) \mid W = w]$. How do they compare? What does this imply about the relative weight given to subgroups of $V$ when calculating $E[Y(a,w)]$ and $E[Y(a) \mid W = w]$?

The weights for $E[Y(a,w)]$ are given by $P(V = v)$. These are all $0.5$ to all subgroups defined by late stage diagnosis. The weights for $E[Y(a) \mid W = w]$ are given by $P(V = v\mid W = w)$. These are somewhat different across the subgroups defined by late stage diagnosis and different chemotherapy levels received. $P(V = v)$ can be further divided into subgroups to get $P(V = v\mid W = w)$. This implies that the weights given in the two equations are different. 

6. (1pt) Characterize the ratio of the weights $P(V = v \mid W = w)/P(V = v)$ in terms of probabilities $P(W = w)$ and $P(W = w \mid V = v)$. (*Hint: use Bayes Theorem*).

\begin{equation}
 \frac{P(V = v \mid W = w)}{P(V = v)} =  \frac{P(W = w \mid V = v)}{P(W = w )}
\end{equation}
\vspace{1em}

Recall that we will say that treatment effect heterogeneity is present on the *additive scale* if $E[Y(1) - Y(0) \mid W = w]$ changes with $w$. We say that there is a causal interaction on the *additive scale* if $E[Y(1,1) - Y(0,0)] \ne E[Y(1,0) - Y(0,0)] + E[Y(0,1) - Y(0,0)]$. 

Similarly, we say that treatment effect heterogeneity is present on the *multiplicative scale* if $E[Y(1) \mid W = w]/E[Y(0) \mid W = w]$ changes with $w$ and that there is a causal interaction on the *multiplicative scale* if $E[Y(1,1)]/E[Y(0,0)] \ne E[Y(1,0)]/E[Y(0,0)] \times E[Y(0,1)]/E[Y(0,0)]$.

For question 7-15 below, a functional form is shown for $E[Y(a,w) \mid V = v]$. Use this form with (\ref{eqn:marginal_Yaw}), (\ref{eqn:conditional_Ya}), and the table from question 4 to write down the value of $E[Y(a) \mid W = w]$ and $E[Y(a, w)]$ for all combinations of $(a,w)$. Then use these values to determine whether treatment effect heterogeneity and/or causal interaction are present on the additive scale and/or multiplicative scale.

\vspace{1em}

7. (1pt) $E[Y(a,w) \mid V = v] = 2 + a + w - v$

8. (1pt) $E[Y(a,w) \mid V = v] = 2 + a + w + wa - v$

9. (1pt) $E[Y(a,w) \mid V = v] = 2 + a - v + av$

10. (1pt) $E[Y(a,w) \mid V = v] = 2 + a + w - v + awv$

11. (1pt) $E[Y(a,w) \mid V = v] = \mbox{exp}(2 + a + w - v)$

12. (1pt) $E[Y(a,w) \mid V = v] = \mbox{exp}(2 + a + w + wa - v)$

13. (1pt) $E[Y(a,w) \mid V = v] = \mbox{exp}(2 + a - v + av)$

14. (1pt) $E[Y(a,w) \mid V = v] = \mbox{exp}(2 + a + w - v + awv)$

15. (6pt) Reflect on your findings in question 7-14. Are there settings where interaction is present but effect heterogeneity is not or vice versa? Does the scale of the effect measure affect your conclusions? If so, how?

\begin{table}[H]
\caption{$E[Y(a, w)]$ and $E[Y(a) \mid W = w]$ for all possible $(a, w)$  \label{table1}}
\centering
\begin{tabular}{c|cccc}
& \multicolumn{4}{|c}{$E[Y(a, w)]$} \\
		& $(a, w)=(0,0)$ & $(a, w)=(0,1)$ & $(a, w)=(1,0)$ & $(a, w)=(1,1)$ \\
\hline
$7$ &   `r (2+0+0-0)*0.5+(2+0+0-1)*0.5`  &  `r (2+0+1-0)*0.5+(2+0+1-1)*0.5`	&  `r (2+1+0-0)*0.5+(2+1+0-1)*0.5` & `r (2+1+1-0)*0.5+(2+1+1-1)*0.5` \\
$8$ &   `r (2+0+0*(1+0)-0)*0.5+(2+0+0*(1+0)-1)*0.5`  &  `r (2+0+1*(1+0)-0)*0.5+(2+0+1*(1+0)-1)*0.5`	&  `r (2+1+0*(1+1)-0)*0.5+(2+1+0*(1+1)-1)*0.5` & `r (2+1+1*(1+1)-0)*0.5+(2+1+1*(1+1)-1)*0.5` \\
$9$ &   `r (2+0-0+0*0)*0.5+(2+0-1+0*1)*0.5`  &  `r (2+0-0+0*0)*0.5+(2+0-1+0*1)*0.5`	&  `r (2+1-0+1*0)*0.5+(2+1-1+1*1)*0.5` & `r (2+1-0+1*0)*0.5+(2+1-1+1*1)*0.5` \\
$10$ &   `r (2+0+0-0+0*0*0)*0.5+(2+0+0-1+0*0*1)*0.5`  &  `r (2+0+1-0+0*1*0)*0.5+(2+0+1-1+0*1*1)*0.5`	&  `r (2+1+0-0+1*0*0)*0.5+(2+1+0-1+1*0*1)*0.5` & `r (2+1+1-0+1*1*0)*0.5+(2+1+1-1+1*1*1)*0.5` \\
$11$ &   `r exp((2+0+0-0))*0.5+exp((2+0+0-1))*0.5`  &  `r exp((2+0+1-0))*0.5+exp((2+0+1-1))*0.5`	&  `r exp((2+1+0-0))*0.5+exp((2+1+0-1))*0.5` & `r exp((2+1+1-0))*0.5+exp((2+1+1-1))*0.5` \\
$12$ &   `r exp((2+0+0*(1+0)-0))*0.5+exp((2+0+0*(1+0)-1))*0.5`  &  `r exp((2+0+1*(1+0)-0))*0.5+exp((2+0+1*(1+0)-1))*0.5`	&  `r exp((2+1+0*(1+1)-0))*0.5+exp((2+1+0*(1+1)-1))*0.5` & `r exp((2+1+1*(1+1)-0))*0.5+exp((2+1+1*(1+1)-1))*0.5` \\
$13$ &   `r exp((2+0-0+0*0))*0.5+exp((2+0-1+0*1))*0.5`  &  `r exp((2+0-0+0*0))*0.5+exp((2+0-1+0*1))*0.5`	&  `r exp((2+1-0+1*0))*0.5+exp((2+1-1+1*1))*0.5` & `r exp((2+1-0+1*0))*0.5+exp((2+1-1+1*1))*0.5` \\
$14$ &   `r exp((2+0+0-0+0*0*0))*0.5+exp((2+0+0-1+0*0*1))*0.5`  &  `r exp((2+0+1-0+0*1*0))*0.5+exp((2+0+1-1+0*1*1))*0.5`	&  `r exp((2+1+0-0+1*0*0))*0.5+exp((2+1+0-1+1*0*1))*0.5` & `r exp((2+1+1-0+1*1*0))*0.5+exp((2+1+1-1+1*1*1))*0.5` 
\end{tabular}
\begin{tabular}{c|cccc}
& \multicolumn{4}{|c}{$E[Y(a) \mid W = w]$} \\
		& $(a, w)=(0,0)$ & $(a, w)=(0,1)$ & $(a, w)=(1,0)$ & $(a, w)=(1,1)$ \\
\hline
$7$ &   `r (2+0+0-0)*(3/4)+(2+0+0-1)*(1/4)`  &  `r (2+0+1-0)*(1/4)+(2+0+1-1)*(3/4)`	&  `r (2+1+0-0)*(3/4)+(2+1+0-1)*(1/4)` & `r (2+1+1-0)*(1/4)+(2+1+1-1)*(3/4)` \\
$8$ &   `r (2+0+0*(1+0)-0)*(3/4)+(2+0+0*(1+0)-1)*(1/4)`  &  `r (2+0+1*(1+0)-0)*(1/4)+(2+0+1*(1+0)-1)*(3/4)`	&  `r (2+1+0*(1+1)-0)*(3/4)+(2+1+0*(1+1)-1)*(1/4)` & `r (2+1+1*(1+1)-0)*(1/4)+(2+1+1*(1+1)-1)*(3/4)` \\
$9$ &   `r (2+0-0+0*0)*(3/4)+(2+0-1+0*1)*(1/4)`  &  `r (2+0-0+0*0)*(1/4)+(2+0-1+0*1)*(3/4)`	&  `r (2+1-0+1*0)*(3/4)+(2+1-1+1*1)*(1/4)` & `r (2+1-0+1*0)*(1/4)+(2+1-1+1*1)*(3/4)` \\
$10$ &   `r (2+0+0-0+0*0*0)*(3/4)+(2+0+0-1+0*0*1)*(1/4)`  &  `r (2+0+1-0+0*1*0)*(1/4)+(2+0+1-1+0*1*1)*(3/4)`	&  `r (2+1+0-0+1*0*0)*(3/4)+(2+1+0-1+1*0*1)*(1/4)` & `r (2+1+1-0+1*1*0)*(1/4)+(2+1+1-1+1*1*1)*(3/4)` \\
$11$ &   `r exp((2+0+0-0))*(3/4)+exp((2+0+0-1))*(1/4)`  &  `r exp((2+0+1-0))*(1/4)+exp((2+0+1-1))*(3/4)`	&  `r exp((2+1+0-0))*(3/4)+exp((2+1+0-1))*(1/4)` & `r exp((2+1+1-0))*(1/4)+exp((2+1+1-1))*(3/4)` \\
$12$ &   `r exp((2+0+0*(1+0)-0))*(3/4)+exp((2+0+0*(1+0)-1))*(1/4)`  &  `r exp((2+0+1*(1+0)-0))*(1/4)+exp((2+0+1*(1+0)-1))*(3/4)`	&  `r exp((2+1+0*(1+1)-0))*(3/4)+exp((2+1+0*(1+1)-1))*(1/4)` & `r exp((2+1+1*(1+1)-0))*(1/4)+exp((2+1+1*(1+1)-1))*(3/4)` \\
$13$ &   `r exp((2+0-0+0*0))*(3/4)+exp((2+0-1+0*1))*(1/4)`  &  `r exp((2+0-0+0*0))*(1/4)+exp((2+0-1+0*1))*(3/4)`	&  `r exp((2+1-0+1*0))*(3/4)+exp((2+1-1+1*1))*(1/4)` & `r exp((2+1-0+1*0))*(1/4)+exp((2+1-1+1*1))*(3/4)` \\
$14$ &   `r exp((2+0+0-0+0*0*0))*(3/4)+exp((2+0+0-1+0*0*1))*(1/4)`  &  `r exp((2+0+1-0+0*1*0))*(1/4)+exp((2+0+1-1+0*1*1))*(3/4)`	&  `r exp((2+1+0-0+1*0*0))*(3/4)+exp((2+1+0-1+1*0*1))*(1/4)` & `r exp((2+1+1-0+1*1*0))*(1/4)+exp((2+1+1-1+1*1*1))*(3/4)` 
\end{tabular}
\end{table}

\begin{table}[H]
\caption{Table to check if Heterogeneous treatment effect and Causal interactions exists  \label{table2}}
\centering
\begin{tabular}{c|cccc}. 
& \multicolumn{4}{|c}{Heteregoneous treatment effect}  \\
& \multicolumn{2}{|c}{Additive} & \multicolumn{2}{c}{Multiplicative}   \\
&	$E[Y(1)-Y(0)\mid W=1]$ & $E[Y(1)-Y(0)\mid W=0]$ & $\frac{E(Y(1)\mid W=1)}{E(Y(0)\mid W=1)}$ & $\frac{E(Y(1)\mid W=0)}{E(Y(0)\mid W=0)}$ \\
\hline
$7$ &   `r y00=(2+0+0-0)*(3/4)+(2+0+0-1)*(1/4)`    `r y01=(2+0+1-0)*(1/4)+(2+0+1-1)*(3/4)`	  `r y10=(2+1+0-0)*(3/4)+(2+1+0-1)*(1/4)`  `r y11=(2+1+1-0)*(1/4)+(2+1+1-1)*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$8$ &   `r y00=(2+0+0*(1+0)-0)*(3/4)+(2+0+0*(1+0)-1)*(1/4)`    `r y01=(2+0+1*(1+0)-0)*(1/4)+(2+0+1*(1+0)-1)*(3/4)`	  `r y10=(2+1+0*(1+1)-0)*(3/4)+(2+1+0*(1+1)-1)*(1/4)`  `r y11=(2+1+1*(1+1)-0)*(1/4)+(2+1+1*(1+1)-1)*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$9$ &   `r y00=(2+0-0+0*0)*(3/4)+(2+0-1+0*1)*(1/4)`    `r y01=(2+0-0+0*0)*(1/4)+(2+0-1+0*1)*(3/4)`	  `r y10=(2+1-0+1*0)*(3/4)+(2+1-1+1*1)*(1/4)`  `r y11=(2+1-0+1*0)*(1/4)+(2+1-1+1*1)*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$10$ &   `r y00=(2+0+0-0+0*0*0)*(3/4)+(2+0+0-1+0*0*1)*(1/4)`    `r y01=(2+0+1-0+0*1*0)*(1/4)+(2+0+1-1+0*1*1)*(3/4)`	  `r y10=(2+1+0-0+1*0*0)*(3/4)+(2+1+0-1+1*0*1)*(1/4)`  `r y11=(2+1+1-0+1*1*0)*(1/4)+(2+1+1-1+1*1*1)*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$11$ &   `r y00=exp((2+0+0-0))*(3/4)+exp((2+0+0-1))*(1/4)`    `r y01=exp((2+0+1-0))*(1/4)+exp((2+0+1-1))*(3/4)`	  `r y10=exp((2+1+0-0))*(3/4)+exp((2+1+0-1))*(1/4)`  `r y11=exp((2+1+1-0))*(1/4)+exp((2+1+1-1))*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$12$ &   `r y00=exp((2+0+0*(1+0)-0))*(3/4)+exp((2+0+0*(1+0)-1))*(1/4)`    `r y01=exp((2+0+1*(1+0)-0))*(1/4)+exp((2+0+1*(1+0)-1))*(3/4)`	  `r y10=exp((2+1+0*(1+1)-0))*(3/4)+exp((2+1+0*(1+1)-1))*(1/4)`  `r y11=exp((2+1+1*(1+1)-0))*(1/4)+exp((2+1+1*(1+1)-1))*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$13$ &   `r y00=exp((2+0-0+0*0))*(3/4)+exp((2+0-1+0*1))*(1/4)`    `r y10=exp((2+0-0+0*0))*(1/4)+exp((2+0-1+0*1))*(3/4)`	  `r y01=exp((2+1-0+1*0))*(3/4)+exp((2+1-1+1*1))*(1/4)`  `r y11=exp((2+1-0+1*0))*(1/4)+exp((2+1-1+1*1))*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\
$14$ &   `r y00=exp((2+0+0-0+0*0*0))*(3/4)+exp((2+0+0-1+0*0*1))*(1/4)`    `r y01=exp((2+0+1-0+0*1*0))*(1/4)+exp((2+0+1-1+0*1*1))*(3/4)`	  `r y10=exp((2+1+0-0+1*0*0))*(3/4)+exp((2+1+0-1+1*0*1))*(1/4)`  `r y11=exp((2+1+1-0+1*1*0))*(1/4)+exp((2+1+1-1+1*1*1))*(3/4)` `r y10-y00` &`r y11-y01` &`r y10/y00` &`r y11/y01` \\

\end{tabular}
\begin{tabular}{c|cccc}
&&&&\\
& \multicolumn{4}{|c}{Causal Interactions}  \\
& \multicolumn{2}{|c}{Additive} & \multicolumn{2}{c}{Multiplcative}  \\
		& $E[Y(1,1)-Y(0,0)]$ & $E[Y(1,0)-Y(0,0)]$+ $E[Y(0,1)-Y(0,0)]$ & $\frac{E[Y(1,1)]}{E[Y(0,0)]}$ & $\frac{E[Y(1,0)]}{E[Y(0,0)]}$$\times$$\frac{E[Y(0,1)]}{E[Y(0,0)]}$\\
\hline
$7$ &   `r y00=(2+0+0-0)*0.5+(2+0+0-1)*0.5`    `r y01=(2+0+1-0)*0.5+(2+0+1-1)*0.5`  `r y10=(2+1+0-0)*0.5+(2+1+0-1)*0.5`  `r y11=(2+1+1-0)*0.5+(2+1+1-1)*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$8$ &    `r y00=(2+0+0*(1+0)-0)*0.5+(2+0+0*(1+0)-1)*0.5`    `r y01=(2+0+1*(1+0)-0)*0.5+(2+0+1*(1+0)-1)*0.5`	  `r y10=(2+1+0*(1+1)-0)*0.5+(2+1+0*(1+1)-1)*0.5`  `r y11=(2+1+1*(1+1)-0)*0.5+(2+1+1*(1+1)-1)*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$9$ &   `r y00=(2+0-0+0*0)*0.5+(2+0-1+0*1)*0.5`    `r y01=(2+0-0+0*0)*0.5+(2+0-1+0*1)*0.5`	  `r y10=(2+1-0+1*0)*0.5+(2+1-1+1*1)*0.5`  `r y11=(2+1-0+1*0)*0.5+(2+1-1+1*1)*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$10$ &   `r y00=(2+0+0-0+0*0*0)*0.5+(2+0+0-1+0*0*1)*0.5`    `r y01=(2+0+1-0+0*1*0)*0.5+(2+0+1-1+0*1*1)*0.5`	  `r y10=(2+1+0-0+1*0*0)*0.5+(2+1+0-1+1*0*1)*0.5`  `r y11=(2+1+1-0+1*1*0)*0.5+(2+1+1-1+1*1*1)*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$11$ &   `r y00=exp((2+0+0-0))*0.5+exp((2+0+0-1))*0.5`    `r y01=exp((2+0+1-0))*0.5+exp((2+0+1-1))*0.5`	  `r y10=exp((2+1+0-0))*0.5+exp((2+1+0-1))*0.5`  `r y11=exp((2+1+1-0))*0.5+exp((2+1+1-1))*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$12$ &   `r y00=exp((2+0+0*(1+0)-0))*0.5+exp((2+0+0*(1+0)-1))*0.5`    `r y01=exp((2+0+1*(1+0)-0))*0.5+exp((2+0+1*(1+0)-1))*0.5`	  `r y10=exp((2+1+0*(1+1)-0))*0.5+exp((2+1+0*(1+1)-1))*0.5`  `r y11=exp((2+1+1*(1+1)-0))*0.5+exp((2+1+1*(1+1)-1))*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$13$ &   `r y00=exp((2+0-0+0*0))*0.5+exp((2+0-1+0*1))*0.5`    `r y01=exp((2+0-0+0*0))*0.5+exp((2+0-1+0*1))*0.5`	  `r y10=exp((2+1-0+1*0))*0.5+exp((2+1-1+1*1))*0.5`  `r y11=exp((2+1-0+1*0))*0.5+exp((2+1-1+1*1))*0.5` `r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
$14$ &   `r y00=exp((2+0+0-0+0*0*0))*0.5+exp((2+0+0-1+0*0*1))*0.5`    `r y01=exp((2+0+1-0+0*1*0))*0.5+exp((2+0+1-1+0*1*1))*0.5`	  `r y10=exp((2+1+0-0+1*0*0))*0.5+exp((2+1+0-1+1*0*1))*0.5`  `r y11=exp((2+1+1-0+1*1*0))*0.5+exp((2+1+1-1+1*1*1))*0.5``r y11-y00`&`r y10-y00+ y01-y00 `&`r y11/y00`&`r (y10/y00)*(y01/y00) `\\
\end{tabular}
\end{table}

\begin{table}[H]
\caption{Summary of Heterogeneous treatment effect and Causal interactions \label{table3}}
\centering
\begin{tabular}{c|cccc}
& \multicolumn{2}{|c}{treatment effect heterogeneity} & \multicolumn{2}{c}{Causal interaction} \\ 
& Additive scale & Multiplicative scale & Additive scale & Multiplicative scale  \\
\hline
$7$ &  No & Yes &  No & Yes \\
$8$ &   Yes & Yes & Yes & Yes \\
$9$ &   Yes & Yes &   No & No\\
$10$ &   Yes & Yes &   Yes & Yes\\
$11$ &   Yes & No &   Yes & No\\
$12$ &   Yes & Yes &   Yes & Yes \\
$13$ &  Yes & Yes &  No & No \\
$14$ &   Yes & Yes &   Yes & Yes\\
\end{tabular}
\end{table}

From Table \label{table1} we can see that $E[Y(a) \mid W = w]$ values are either greater or the same as the respective  $E[Y(a, w)]$. There are no models where causal interaction is present but there is no heterogeneous treatment effect. In model 9 and 13 there is heterogeneous treatment effect present but there is no causal interaction, under both the additive and multiplicative scale. In model 7 and 11 scale effects measure affect conclusions with regards to both conclusions made about heterogeneous treatment effect and causal interactions.

16. (BONUS 0pt) Prove (\ref{eqn:conditional_Ya}) assuming \begin{enumerate}
\item[(A1)] {\it Causal consistency}: for any individual $i$ in the population with $W_i = w$, we have that $Y_i(a) = Y_i(a,w)$. The assumption states that any individual in the population observed to "naturally" undergo chemotherapy has the same potential outcome as if they had been assigned to chemotherapy by our hypothetical intervention.
\item[(A2)] {\it Independence/no unmeasured confounding}: $Y(a,w) \perp W \mid V$. The assumption states that $V$ contains all confounders (or is sufficient to block all backdoor paths between $Y$ and $W$ in a DAG).
\end{enumerate}

